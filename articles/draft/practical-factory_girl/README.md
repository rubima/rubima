# More practical factory_girl

## はじめに

factory_girlを代表とするFixture Replacementの登場により、テストデータの定義や作成が容易にできるようになりました。

しかしながら、ライブラリの使い方を知っただけでは、変化しつづけるアプリケーションに合わせてテストデータをメンテナンスし続けるのは困難だと感じています。

本記事では、筆者がRubyKaigi2014 Lightning Talksで発表した内容をベースに、factory_girlと長く付き合っていくにあたり気を付けるべきポイントやお勧めの使い方を紹介します。

### 入門factory_girl

## 継承よりtrait

factory_girlでは、似たようなテストデータを定義する方法がいくつかあります。

## factory_girlとfixtureとクリエイションメソッド

## イベントデータとクリエイションメソッド

### factory_girlとfixture

全てのテストデータをfixture replacementで作り、Rails標準のfixtureは使わないほうがよいのでしょうか？

Rubykaigi2014ではPrathamesh Sonpatki氏がDeep down fixturesというトークでfixtureの機能を網羅的するトークがありました。詳しくは氏の資料を見ていただきたいのですが、fixture replacementはfixtureの上位互換なのではなく、それぞれに特徴があることがわかります。

fixtureの注目すべき特徴は2つあります。

- コールバックやバリデーションがない代わりに高速であるということ
- CSVフォーマットが標準でサポートされている

これらの特徴を活かせる状況では、fixtureを使うほうがよいと考えられます。例えば以下のようなデータです。

- 変更頻度が低く、またバリデーションが必要ないデータ(例: 都道府県マスタ)
- 非プログラマとコミュニケーションをとるためにCSVで管理したほうが利便性の高いデータ(例: 業種や職種マスタ)

fixture replacementという名前に惑わされず、適材適所でツールを選択することが重要です。

## 資産価値の高いテストデータ

### 名前付けとユビキタス言語

### テストコードからテストデータを見直す

## まとめ
